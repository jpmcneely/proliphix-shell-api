
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>Thermostat Main Floor - Advanced Settings</title>
<!-- <link rel="stylesheet" type="text/css" href="styles.css"> -->
<style type="text/css">
html,body, div, table, th, tr, tbody {

	margin: 0px;

	padding: 0px;

	font-size: 100%;

	border: none;

}

body {

	font-family: verdana, sans-serif;

	font-size: 10pt; 

	background-color:white;

	color: #03a;

	text-align: center; /* IE5/Win centering */

	height: 100%;

        padding-left: 10px;

}

/* Outer */

#content {

	width: 629px;

	margin-top: 10px;

	margin-left: auto;

	margin-right: auto;

	text-align: left; /* Uncenter inherited from body */

}

/* Main content */

#body {

	text-align: left;

	border-left: solid #C6202E 8px;

	padding-left: 5px; /* in addition to border-left */



	margin-left: 108px;

	margin-left: 91px;

}

html>body #body {

    margin-left:105px; 

    margin-left:88px; 

    padding-left: 8px;}

/* Left Navigation Bar */

#navbar {

	position: relative;

	float: left;

	display: inline;



	width: 102px;

	width: 85px;

	height: 100%;

}

/* Mozilla reads this, overriding what's above */

html>body #navbar {

  width:82px;

}

A:hover {

 text-decoration: underline;

}

#header A, #header A:link, #header A:visited

{

color: white;

text-decoration: none;

}

#header A:hover

{ color: #FFCC33; border-bottom: solid 1px #FFCC33; }  

H1, .head, .modnum

{ 

	padding: 2px;

	font-size: 110%;

	background: #FFCC33;  

	text-align: left;

    font-weight: bold;

}

.modnum

{

	margin: 0px 0px;

	text-align: center;

	margin-bottom: 5px;

}

H2 

{ font-size:110%; }

H3

{ 

font-size: 100%;

margin-top: 15px;

margin-bottom: 2px;

text-decoration: underline;

}

P

{ margin: 3px; }

#navbar A, #navbar A:link, #navbar A:visited

{ 

text-decoration: none;

color: white;

}

#navbar A:hover

{ 

	color: #FFCC33; 

} 

/* Outer */

#navbar .tab {

}



#navbar .tabcontainer {

  padding: 0px 0px;

  text-align: center;

  font-weight: bold;

  font-family: sans-serif;

  font-variant: small-caps;



  /* Unselected */

  background: #207ebf;

}



/* Outer Selected */

#navbar .selected {

}



/* Inner Selected */

#navbar .selected .tabcontainer {

  background: #C6202E;

}



#navbar .spacer {

    font-size: 0;

    height: 2px;

}



.rtop,.rbottom{display:block}

.rtop *,.rbottom *{display:block;height: 1px;overflow: hidden}

.r1{margin: 0 5px}

.r2{margin: 0 3px}

.r3{margin: 0 2px}

.r4{margin: 0 1px;height: 2px}



.rs1{margin: 0 2px}

.rs2{margin: 0 1px}





TABLE.config 

{ 

	empty-cells: show;

	width: 505px;

}

html>body .config {width:507px;}



.config TD

{ 

	padding: 3px; 

	background: white;

	border-bottom: solid 1px #bbe;

}

TD.box { background: #c8e0f0; }

TD.function { width: 30%; }

TD.status { background: #c8e0f0; width: 35%; text-align: center; } 

TD.control { width: 35%; text-align: center; }

TD.alarm { border-left: solid 1px #bbe; width: 35%; text-align: center; } 

TD.alarmhdr { width: 35%; text-align: center; font-weight:bold} 

TD.i2p { width: 35%; text-align: left;}

TD.sectionhead { 

	padding-top: 4px;

	font-size: 110%;

	font-weight: bold;

	font-style: italic;

	border-bottom: solid 1px #03a;

}

TD.date

{ 

padding-top: 6px;

font-size: 100%;

font-weight: bold;

font-style: italic;

border-bottom: solid 1px #03a;

}

TABLE.setback2

{

background: #aaaaaa;

margin-top: 19px;

}

TABLE.setback

{ 

background: #03a;

width: 495px;

margin-top: 19px;}

TABLE.spec

{ background: #03a; 

padding: 0px;}

.setback TD

{ font-size:90%; 

background: #99c;

font-weight: bold;

margin: 3px; padding: 3px;

}

.setback TD, TD.setback 

{ 

	font-size:90%; 

	background: #fff;

	margin: 3px; padding: 3px;

}

.setback TD 

{	

	border: none;

	background: white 

}

.spec TD, TD.spec

{ border: solid 1px #03a; }

TH.sb_day { background: #dddddd; }  

TD.spechead { background: #dddddd; font-weight: bold; }

#today { font-weight: bold; border: solid 3px #03a; }

TD.hd_time { background: #dddddd; } 

TD.sbunused, .sbunused {  background: white; } 

TD.sb1, .sb1 { text-align: center; background: #c8e0f0; font-weight: bold;} 

TD.sb2, .sb2 { text-align: center; background: #ffe071; font-weight: bold;}

TD.sb3, .sb3 { text-align: center; background: #ff9080; font-weight: bold;}

TD.sb4, .sb4 { background: #aaf; }

TD.sb5, .sb5 { width: 90px; text-align: center; background: #ff9080; font-weight: bold;}

TD.sbtemp { font-weight: bold; background: #ccc; }

TD.mon_name { background: #cdcdff;  }

.opt, .optsel { margin: 1px; padding: 1px; border: solid 1px #03a; }

.opt { color: #03a; background: #c8e0f0; }

.optsel { color: #c8e0f0; background: #03a; }



#day { font-size: 100%; margin:0; padding:0; color: #03a; text-decoration: none; }

#specday { border: solid 1px red; }

#spectoday { border: solid 3px red; }

form, input {

	margin: 0px;

	padding: 0px;

}




</style>
<!-- <script type="text/javascript" src="com.js"></script> -->
<script type="text/javascript">
function td(x,c,span,other)
{
t = "<td"
if (c) t += " class=" + c
if (span) t += " colspan=" + span
if (other) t += " " + other
if (!x) x = "&nbsp;"
t += ">" + x + "</td>"
return t
}

function tr(x) { return "<tr>" + x + "</tr>" }

function printTitle(t, n)
{
wln ("<tr><th colspan=2 class=head>" + t + "</th><th class=head style='text-align:right;'>" + n + "</th></tr>")
}

function printSect(s,d)
{
if (d)
wln ("<tr><td colspan=1 class=sectionhead>"+s+"</td><td colspan=2 class=date style='text-align:right;'>"+d+"</td></tr>");
else
wln ("<tr><td colspan=3 class=sectionhead>"+s+"</td></tr>")
}

function printFSC(f,s,c)
{
fc = "function"
if (f == "")
{ f = "&nbsp;"; fc = null; }

wln ("<tr>" + td(f, fc) + td(s,"status") + td(c,"control") + "</tr>")
}

function printFC2(f,c)
{ wln (tr(td(f,"function") + td (c, "control", 2))) }

function printFS2(f,s)
{ wln (tr(td(f,"function") + td (s, "status", 2))) }

function printRefreshSubmit()
{
printFSC("", linkbuttonGet('location.href', 'Refresh'), "<input type=submit name='submit' value='Submit'>")
}

function printNavLine(c,ref,ref2,ref3,ref4,ref5,ref6)
{
if (location.href.indexOf('?') != -1) {
var page = location.href.substring( location.href.lastIndexOf('\/')+1,location.href.indexOf('?'));
}
else {
var page = location.href.substring( location.href.lastIndexOf('\/')+1);
}
var tabname = "tab";
if( ref == page || ref2 == page || ref3 == page || ref4 == page || ref5 == page || ref6 == page)
tabname += " selected";
else
tabname += " roundbox";
wln('<div class="' + tabname + '">');
wln('<div class="tabcontainer">');
wln("<a href='" + ref + "'>"+ c + "</a>" + "</div>")
wln('</div>');
wln("<div class=\"spacer\"></div>");
}

function bodyStart(a,n)
{
wln("<div id=body>")
if (a != "")
{
wln("<form method='post' action='" + a + "' name='" + n + "'>")
}
wln("<table id=maintable class=config cellspacing=0>")
}
function printHead(admin,mg,v,m)
{
wln("<div id=navbar>")
wln("<div class='modnum'>" + m + v + "</div>");
printNavLine("Status &<br> Control", "index.shtml")
printNavLine("General<br>Settings", "settings.shtml")
printNavLine("Setback<br>Schedules", "schedule.shtml", "weekly.shtml", "schhome.shtml", "schwork.shtml","schvac.shtml","specdays.shtml")
if (mg&1)
{
wln('<div class="spacer" style="height: 10px"></div>');
if (admin==2) 
{
printNavLine("Network Settings", "network.shtml")
printNavLine("Advanced<br>Settings", "adv.shtml")
if (mg & 2) {
printNavLine("Sensor<br>Settings", "sensors.shtml")
}
printNavLine("Remote<br>Access", "adv2.shtml", "ch");
printNavLine("Installer<br>Info", "installer.shtml");
}
}
else
{
printNavLine("Network Settings", "network.shtml")
printNavLine("Advanced<br>Settings", "adv.shtml")
if (mg & 2) {
printNavLine("Sensor<br>Settings", "sensors.shtml")
}
printNavLine("Remote<br>Access", "adv2.shtml", "ch")
}
printNavLine("Usage<br>Counters", "usage.shtml")
printNavLine("Password<br>Settings", "admin.shtml")
if (admin!=1) {
printNavLine("Logout", "logout")
}

wln("</div>")
Rounded("div.roundbox", "transparent", "#207ebf");
Rounded("div.selected", "transparent", "#C6202E");
}
function wln(m) { document.writeln(m); }
function htmlTitle(n, t)
{ document.title = "Thermostat " + n + " - " + t; }
function bodyEnd()
{ wln("</table></form></div>") }
function bodyEndNoForm(tail)
{
wln("</table>")
if (tail != "")
{ wln(tail) }
wln("</div>")
}
function addOpt(n, val , i, opt0, opt1)
{
el = document.forms[0].elements[n]
el.options[i] = new Option(opt1, opt0, opt0 == parseInt(val), opt0 == parseInt(val))
el.value = val
}
function addOpts(n, val ,opts)
{
el = document.forms[0].elements[n]
for (var i=0; i<opts.length; i++)
{
el.options[i] = new Option(opts[i][1], opts[i][0], opts[i][0] == parseInt(val), opts[i][0] == parseInt(val))
}
el.value = val
}
function makeSelect(n,opts)
{
if (!opts) opts = ""
return "<select name='" + n + "' " + opts + "></select>"
}
function makeCheck(n,v,s)
{
return "<input type=checkbox name='" + n + "' value='" + v + "'> " + s;
}
function makeInput(n,v,size,msize,cf)
{
if (v)
v = ' value="' + v + '"'
else
v = ""

if (msize) {
mlen = msize;
}
else {
mlen = size;
}
return "<input name='" + n + "' size=" + size + " maxlength=" + mlen + " onChange='" + cf + "' + " + v + ">";
}
function makePwInput(n,size,onChange,onf)
{
return "<input type=password name='" + n + "' id='" + n + "' size=" + size + " maxlength=" + size +
" onchange=" + onChange + " onfocus=" + onf + " >";
}
function linkbutton(href,label)
{ wln (linkbuttonGet(href,label)) }
function linkbuttonGet(href,label)
{ return "<input type=button value='"+label+"' onclick='location.href=" + href + "'>" }
function getArg (name) {
args = location.search.slice(1).split('&')
if (args == "") return ''
r = ''
for (var i = 0; i < args.length; i++) {
if (args[i].slice(0,args[i].indexOf('=')) == name) {
r = args[i].slice(args[i].indexOf('=')+1);
break;
}
}
return (r.length > 0 ? unescape(r).split(',') : '')
}
function rndCmp(x,y)
{
return (Math.round(x/10) * 10) == (Math.round(y/10) * 10);

}
function hc_options(tSc,h,c,he,ce,hi,ci,start,inc,end,astart,ainc,aend,os)
{
if (tSc==2) {
start = astart
inc = ainc
end = aend
}
for (j=os; j<end; j++) {
dd = start
if (tSc==2) {
dd = (start*9/5)+32
}
dd *= 10;
dd = Math.round(dd);
if (he) {
h.options[j] = new Option(start, dd, dd == hi, dd == hi)
}
if (ce) {
c.options[j] = new Option(start, dd, dd == ci, dd == ci)
}
start += inc
}
}
function chtime(secs)
{
now = new Date();
d2 = new Date( 1000*(secs+(60*now.getTimezoneOffset())) );
da = d2.toLocaleDateString() + " " + d2.toLocaleTimeString();
return da;
}


function NiftyCheck()
{
if(!document.getElementById || !document.createElement)
return(false);
var b=navigator.userAgent.toLowerCase();
if(b.indexOf("msie 5")>0 && b.indexOf("opera")==-1)
return(false);
return(true);
}

function Rounded(selector,bk,color,size){
var i;
var v=getElementsBySelector(selector);
var l=v.length;
for(i=0;i<l;i++){
AddTop(v[i],bk,color,size);
AddBottom(v[i],bk,color,size);
}
}

function AddTop(el,bk,color,size){
var i;
var d=document.createElement("b");
var cn="r";
var lim=4;
if(size && size=="small"){ cn="rs"; lim=2}
d.className="rtop";
d.style.backgroundColor=bk;
for(i=1;i<=lim;i++){
var x=document.createElement("b");
x.className=cn + i;
x.style.backgroundColor=color;
d.appendChild(x);
}
el.insertBefore(d,el.firstChild);
}

function AddBottom(el,bk,color,size){
var i;
var d=document.createElement("b");
var cn="r";
var lim=4;
if(size && size=="small"){ cn="rs"; lim=2}
d.className="rbottom";
d.style.backgroundColor=bk;
for(i=lim;i>0;i--){
var x=document.createElement("b");
x.className=cn + i;
x.style.backgroundColor=color;
d.appendChild(x);
}
el.appendChild(d,el.firstChild);
}

function getElementsBySelector(selector){
var i;
var s=[];
var selid="";
var selclass="";
var tag=selector;
var objlist=[];
if(selector.indexOf(" ")>0){  
s=selector.split(" ");
var fs=s[0].split("#");
if(fs.length==1) return(objlist);
return(document.getElementById(fs[1]).getElementsByTagName(s[1]));
}
if(selector.indexOf("#")>0){ 
s=selector.split("#");
tag=s[0];
selid=s[1];
}
if(selid!=""){
objlist.push(document.getElementById(selid));
return(objlist);
}
if(selector.indexOf(".")>0){  
s=selector.split(".");
tag=s[0];
selclass=s[1];
}
var v=document.getElementsByTagName(tag);  
if(selclass=="")
return(v);
for(i=0;i<v.length;i++){
if(v[i].className.match(selclass)){
objlist.push(v[i]);
}
}
return(objlist);
}

function printStatusHead(admin,m,v)
{
wln("<div id=navbar>")
wln(tr("<div class='modnum'>" + m + v + "</div>"))
printNavLine("Status", "status.shtml")
printNavLine("Login", "index.shtml")

wln("</div>")
Rounded("div.roundbox", "transparent", "#207ebf");
Rounded("div.selected", "transparent", "#C6202E");
}

</script>
<script type="text/javascript">

var mimGrade = parseInt("2");
var pro = (mimGrade&1==1)
var extRelay = (mimGrade&8)
var humidity = (mimGrade&4)
var devName = "Main Floor"
var pageTitle = "Advanced Settings"

if ( parseInt("2") != 2 ) {
location.href="status.shtml"
}

var hON = "Heat Offset"
var HAON1 = "2nd Stage Offset"
var HAON = "Aux Heat Offset"
var n_sys = "OID4.2.14";

var n_ch = "OID4.2.1";
var n_cc = "OID4.2.2";
var n_c2o = "OID4.1.18";
var n_c20_e = false;
var n_h2o = "OID4.1.17";
var n_h2o_e = false;
var n_h3o = "OID4.1.25";
var n_h3o_e = false;
var n_ct = "OID4.2.15";
var n_tv = "OID4.2.5";
var n_cphh = "OID4.2.24";
var n_cphc = "OID4.2.23";
var n_ho = "OID4.1.22";
var n_foh = "OID4.2.21";
var n_foh = "OID4.2.21";
var n_hr = "OID4.2.20";
var n_hrt = "OID4.2.19";
var n_vp = "OID4.2.29";
var n_ah = "OID4.2.30";
var n_ssd = "OID4.2.26";
var vh = 1;
var vc = 1;
var ah = 1;
var ts = "F";
var tSc = parseInt("1")
if ( tSc == 2 ) {
ts = "C";
}

var isSafari = (document.childNodes)&&(!document.all)&&(!navigator.taintEnabled)&&(!navigator.accentColorName);

function init()
{ htmlTitle(devName, "Advanced Settings")}

function deleteAllRows()
{
table = document.getElementById('maintable');
var tableSize = table.rows.length;

for ( var i=1;i < tableSize;i++ ) {
if ( !isSafari )
table.deleteRow(1);
else {
row = table.rows[table.rows.length-1];
table.removeChild(row);
}
}
n_c20_e = false;
n_h2o_e = false;
n_h3o_e = false;
}

function appendRow(f,s,c)
{
table = document.getElementById('maintable')

insertRow(table.rows.length,f,s,c);
}
function createElement(element) {
if ( typeof document.createElementNS != 'undefined' ) {
return document.createElementNS('http://www.w3.org/1999/xhtml', element);
}
if ( typeof document.createElement != 'undefined' ) {
return document.createElement(element);
}
return false;
}

function insertRow(rowNum,f,s,c)
{
table = document.getElementById('maintable')

var cell1 = null;
var cell2 = null;
var cell3 = null;
try {
if ( isSafari ) throw new Exception();
row = table.insertRow(table.rows.length);
cell1 = row.insertCell(-1);
cell2 = row.insertCell(-1);
cell3 = row.insertCell(-1);
}catch(e) {
}
if ( !cell1 ) {
var trElem = createElement("tr");
table.appendChild(trElem);
var cell1 = createElement("td");
trElem.appendChild(cell1);
var cell2 = createElement("td");
trElem.appendChild(cell2);
var cell3 = createElement("td");
trElem.appendChild(cell3);
}
cell1.innerHTML = f;
cell1.setAttribute("class","function")
cell1.setAttribute("className","function")

cell2.innerHTML = s;
cell2.setAttribute("class","status")
cell2.setAttribute("className","status")

cell3.innerHTML = c;
cell3.setAttribute("class","control")
cell3.setAttribute("className","control")

}
function appendSection(text)
{
table = document.getElementById("maintable")
var oCell = null;
try {
if ( isSafari ) throw new Exception();
row = table.insertRow(table.rows.length);
oCell = row.insertCell(-1);
}catch(e) {
}
if ( !oCell ) {
var trElem = createElement("tr");
table.appendChild(trElem);
var oCell = createElement("td");
trElem.appendChild(oCell);
}
oCell.innerHTML = text;
oCell.colSpan = "3";
oCell.setAttribute("class","sectionhead")
oCell.setAttribute("className","sectionhead")

}

function changeType()
{
vh = 1;
vc = 1;
ah = 1;

if ( document.forms[0].elements[n_sys].value == 1 ) {
if ( n_c20_e ) {
document.forms[0].elements[n_c2o].value = 20;
}
} else {
document.forms[0].elements[n_ct].value = 5;
}
if ( n_h2o_e ) {
document.forms[0].elements[n_h2o].value = 20;
}
if (n_h3o_e) {
document.forms[0].elements[n_h30].value = 20;
}
renderpage(true,true);
}

function renderpage(deleteRows,changeType)
{
var d_stage = 0;

if ( deleteRows==true ) {
v_sys = document.forms[0].elements[n_sys].value;
if ( !changeType ) {
vh = document.forms[0].elements[n_ch].value;
vc = document.forms[0].elements[n_cc].value;
if (v_sys==2) {
ah = document.forms[0].elements[n_ah].value;
}
}
deleteAllRows();
} else {
v_sys = parseInt("1");
vh = parseInt("2");
vc = parseInt("2");
ah = parseInt("2");
}

appendSection("HVAC Configuration");

v_sys_t = parseInt("1");
if ( v_sys_t==1 )
sys = "Fuel Burner";
else if ( v_sys_t==2 )
sys = "Heat Pump";

appendRow("HVAC System Type",sys,makeSelect(n_sys,"onChange=changeType()"));
addOpts(n_sys,v_sys,[[1,"Fuel Burner"],[2,"Heat Pump"]])

vc_t = parseInt("2");
vh_t = parseInt("2");
ah_t = parseInt("2");

if ( (vc > 2) || (vh > 2) || (ah>1 && v_sys==2) ) {
d_stage = 1;
}

if ( vh_t==1 ) {
vs = "Disabled";
} else if ( vh_t == 2 ) {
if (pro)
vs = "1H";
else
vs = "Enabled";
} else if ( vh_t == 3 ) {
vs = "2H";
} else {
vs = "Unknown";
}


if ( pro && v_sys == 2) {
vpo = parseInt("1");
appendRow("<span id=\"rvp\"> Reverse Valve Polarity</span>","<span id=\"rvps\">O</span>", makeSelect(n_vp, null));
addOpts(n_vp, vpo,[[1,"O"],[2,"B"]]);

if ( vc < 3 && vh < 3 ) {
document.forms[0].elements[n_vp].disabled = true;
document.getElementById("rvp").style.color = "gray";
document.getElementById("rvps").style.color = "gray";
}
}
appendRow("Heat Control",vs, makeSelect(n_ch,"onChange=renderpage(true,false)"));
if ( pro ) {
addOpts(n_ch,vh,[[1,"Disable"],[2,"1H"],[3,"2H"]]);
} else {
addOpts(n_ch,vh,[[1,"Disable"],[2,"Enable"]]);
}

v = parseInt("20");
vs = "2.0";
v3 = parseInt("20");
v3s = "2.0";
if ( pro ) {
n_h2o_e = true;
appendRow("&nbsp;&nbsp;&nbsp;<span id=\"heatoffset\" >" + "d" + "</span>",
"<span id=\"heatoffstatus\"> -"+vs+"&deg;"+ts+"</span>",
"-"+makeSelect(n_h2o,null)+"&deg;"+ts);
if ( tSc==2 ) {
addOpts(n_h2o,v,[[0,"0.0"],[18,"1.0"],[27,"1.5"],[36,"2.0"],[45,"2.5"],[54,"3.0"]]);
} else {
addOpts(n_h2o,v,[[0,0],[20,2],[30,3],[40,4],[50,5],[60,6]]);
}

el = document.getElementById("heatoffset");
el.firstChild.data = HAON1;

if ( vh != 3 ) {
document.forms[0].elements[n_h2o].disabled = true;
document.getElementById("heatoffset").style.color = "gray";
document.getElementById("heatoffstatus").style.color = "gray";
}
}

if (v_sys == 2) {
ahs = "Disabled";
if (ah_t==2)
ahs = "Enable w/ Comp";
else if (ah_t==3)
ahs = "Enable w/o Comp";
appendRow("Auxiliary Heat", ahs, makeSelect(n_ah, "onChange=renderpage(true,false)"));
addOpts(n_ah, ah,[[1,"Disable"],[2,"Enable w/ Comp"],[3,"Enable w/o Comp"]]);
appendRow("&nbsp;&nbsp;&nbsp;<span id=\"heatoffset1\" >" + "d" + "</span>",
"<span id=\"heatoffstatus1\"> -"+v3s+"&deg;"+ts+"</span>",
"-"+makeSelect(n_h3o,null)+"&deg;"+ts);
if ( tSc==2 ) {
addOpts(n_h3o,v3,[[0,"0.0"],[18,"1.0"],[27,"1.5"],[36,"2.0"],[45,"2.5"],[54,"3.0"]]);
} else {
addOpts(n_h3o,v3,[[0,0],[20,2],[30,3],[40,4],[50,5],[60,6]]);
}
el = document.getElementById("heatoffset1");
el.firstChild.data = HAON;

if (ah==1) {
document.forms[0].elements[n_h3o].disabled = true;
document.getElementById("heatoffset1").style.color = "gray";
document.getElementById("heatoffstatus1").style.color = "gray";
}

}

if ( vc_t==1 ) {
vs = "Disabled";
} else if ( vc_t == 2 ) {
if (pro)
vs = "1C";
else
vs = "Enabled";
} else if ( vc_t == 3 ) {
vs = "2C";
} else {
vs = "Unknown";
}

appendRow("Cool Control",vs,makeSelect(n_cc,"onChange=renderpage(true,false)"))
if ( pro )
addOpts(n_cc,vc,[[1,"Disable"],[2,"1C"],[3,"2C"]]);
else
addOpts(n_cc,vc,[[1,"Disable"],[2,"Enable"]]);

v = parseInt("20");
vs = "2.0";
if ( pro ) {
n_c20_e = true;
appendRow("&nbsp;&nbsp;&nbsp;<span id=cooloffset >" + "2nd Stage Offset" + "</span>",
"<span id=\"cooloffstatus\">+"+vs+"&deg;"+ts+"</span>",
"+"+makeSelect(n_c2o,null)+"&deg;"+ts);
if ( tSc==2 ) {
addOpts(n_c2o,v,[[0,"0.0"],[18,"1.0"],[27,"1.5"],[36,"2.0"],[45,"2.5"],[54,"3.0"]]);
} else {
addOpts(n_c2o,v,[[0,0],[20,2],[30,3],[40,4],[50,5],[60,6]]);
}

if ( vc < 3 ) {
document.forms[0].elements[n_c2o].disabled = true;
document.getElementById("cooloffset").style.color = "gray";
document.getElementById("cooloffstatus").style.color = "gray";
}
}
appendSection("Thermostat Configuration");

v = parseInt("3");
if ( v==0 ) {
vs = "Perm";
} else {
vs = v + " hr";
}
appendRow("Hold Mode Duration",vs,makeSelect(n_ho,null)+"hr");
addOpts(n_ho,v,[[0,"Perm"],[1,"1"],[3,"3"],[8,"8"],[12,"12"],[24,"24"]]);

v = parseInt("180");
dv = v;
if ( v < 180 ) {
dv = 0;
}
vs = dv/60 + " min";
appendRow("Compressor Delay",vs,makeSelect(n_ct,null)+"min");
addOpts(n_ct,v,[[10,0],[180,3],[240,4],[300,5],[360,6],[420,7],[480,8],[540,9],[600,10]]);

if (d_stage) {
v = parseInt("10");
if (v==10)
vs = 0;
else
vs = v / 60;
vs += " min";
appendRow("2<sup>nd</sup> Stage Delay",vs,makeSelect(n_ssd,null)+"min");
addOpts(n_ssd,v,[[10,0],[300,5],[900,15],[1800,30],[2700,45],[3600,60],[5400,90]]);
}

appendRow("Fan on Heat","Disabled",makeSelect(n_foh,null));
addOpts(n_foh,parseInt("1"),[[1,"Disable"],[2,"Enable"]]);

if ( pro ) {
v = parseInt("10");
dv = v;
if (tSc==2) {
dv *= 5/9;
dv += .1;
}
dv /= 10.0;
dv *= 2.0;
appendRow("Setpoint Differential",dv.toFixed(1) + "&deg;" + ts,makeSelect(n_tv,null)+ "&deg;" + ts);

if ( tSc==2 ) {
addOpts(n_tv,v,[[9,1.0],[13,1.5],[18,2.0],[22,2.5],[27,3.0]]);
} else {
addOpts(n_tv,v,[[10,2],[15,3],[20,4],[25,5],[30,6]]);
}

cph = new Array(0,60,30,20,15,12,10,6,5);

v = parseInt("0");
vs = "Disabled";
if (v) {
vs = 60/v;
}
appendRow("Max Cool Cycles/hr",vs,makeSelect(n_cphc,null));
addOpt(n_cphc,v,0,0,"Disable");
for (i=1;i < cph.length;i++) {
addOpt(n_cphc,v,i,cph[i],60/cph[i]);
}

v = parseInt("0");
vs = "Disabled";
if (v) {
vs = 60/v;
}
appendRow("Max Heat Cycles/hr",vs,makeSelect(n_cphh,null));
addOpt(n_cphh,v,0,0,"Disable");
for (i=1;i < cph.length;i++) {
addOpt(n_cphh,v,i,cph[i],60/cph[i]);
}
}

if ( humidity && vc > 1 ) {
var n_hum = "OID4.2.22";
var tcHC = parseInt("0");
vc = "%";
if ( tcHC==0 ) {
vs = "Disabled";
vc = "";
} else
vs = tcHC.toString()+ "% RH";

appendRow("A/C Humidity Control",vs,makeSelect(n_hum,null)+"% RH");

el = document.forms[0].elements[n_hum];
addOpt(n_hum,tcHC,0,0,"Disable");
for ( j=1; j<18; j++ ) {
var h = (j * 5) + 5;
addOpt(n_hum,tcHC,j,h,h);
}
}

if ( extRelay ) {
appendSection("External Relay Configuration");

rhv = parseInt("1");
rhvs = "Disabled";
if ( rhv == 2 ) {
rhvs = "Above Humidity";
} else if ( rhv == 3 ) {
rhvs = "Below Humidity";
} else if ( rhv == 4 ) {
rhvs = "Above Temperature";
} else if ( rhv == 5 ) {
rhvs = "Below Temperature";
}
appendRow("External Relay Trigger",rhvs,makeSelect(n_hr,null));
addOpts(n_hr,rhv,[[1,"Disable"],[2,"Above Humidity"],
[3,"Below Humidity"],[4,"Above Temperature"],[5,"Below Temperature"]]);
if ( rhv>1 ) {
if ( rhv>3 ) {
start = -30;
inc = 1;
count = 231;
tcc = "&deg;" + ts;
} else {
start = 10;
inc = 5;
tcc = "%";
count = 17;
}
rhtv = parseInt("0");
appendRow("&nbsp;&nbsp;&nbsp;Threshold", rhtv + tcc, makeSelect(n_hrt, null) + tcc);
for ( j=0; j<count; j++ ) {
var h = j * inc + start;
addOpt(n_hrt,rhtv,j,h,h);
}
v = parseInt("1");
n_pol = "OID4.2.28";
appendRow("&nbsp;&nbsp;&nbsp;Activate Polarity","Closed",makeSelect(n_pol,null));
addOpts(n_pol,v,[[1,"Closed"],[2,"Open"]]);

v = parseInt("1");
n_for = "OID4.2.27";
appendRow("&nbsp;&nbsp;&nbsp;Activate HVAC Fan","Disabled",makeSelect(n_for,null));
addOpts(n_for,v,[[1,"Disable"],[2,"Enable"]]);
}
}

appendSection("Thermostat Initialization");

n_reset = "OID1.9"
appendRow("Reset on Submit","&nbsp;","<select name=" + n_reset + "><option value='1' selected>No Action<option value='2'>Software Reset</select>");

appendRow("", linkbuttonGet('location.href', 'Refresh'), "<input type=submit name='submit' value='Submit'>");
}

</script>
</head>

<body onLoad="init()">

<center>
<div id="content">

<script type="text/javascript">
printHead(parseInt("2"),parseInt("2"),"e", "NT20")

bodyStart("adv.shtml", "adv")

printTitle(pageTitle, devName)

renderpage(false,false);

wln("<input type=hidden value=0 name=x>")

bodyEnd()
</script>

</div>
</center>
</body>

